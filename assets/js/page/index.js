var JobsData = [
    {
        "id": 1,
        "user_id": 1,
        "company_name": "Trendyol",
        "job_status": "Full time",
        "job_title": "Production",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    },
    {
        "id": 2,
        "user_id": 1,
        "company_name": "Morbi",
        "job_status": "Full time",
        "job_title": "Mechanical engineering / Technical works",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    },
    {
        "id": 3,
        "user_id": 1,
        "company_name": "Batubara",
        "job_status": "Full time",
        "job_title": "Technical works",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    },
    {
        "id": 4,
        "user_id": 1,
        "company_name": "Doku",
        "job_status": "Full time",
        "job_title": "Software engineering",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    },
    {
        "id": 5,
        "user_id": 1,
        "company_name": "OVO",
        "job_status": "Full time",
        "job_title": "Mobile Apps Developer",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    }
]

var frequentlyJobs = [
    {
        "count": 10,
        "job_title": "Mechanical engineering / Technical works"
    },
    {
        "count": 7,
        "job_title": "Production"
    },
    {
        "count": 5,
        "job_title": "Technical works"
    },
    {
        "count": 4,
        "job_title": "Mobile Apps Developer"
    },
    {
        "count": 2,
        "job_title": "Software engineering"
    }
]

var feedback =[
    {
        "feedback_comment": "Lorem ipsum dolor sit amet,consetetur sadipscing elitr, seddiam nonu eirmod tempor invidunt labore.Lorem ipsum dolor sit amet,consetetur sadipscing elitr, seddiam nonu.",
        "feedback_point": 10,
        "user_id": 3,
        "firstname": "rahadhian",
        "lastname": "yana"
    },
    {
        "feedback_comment": "Lorem ipsum dolor sit amet,consetetur sadipscing elitr, seddiam nonu eirmod tempor invidunt labore.Lorem ipsum dolor sit amet,consetetur sadipscing elitr, seddiam nonu.",
        "feedback_point": 10,
        "user_id": 1,
        "firstname": "yana",
        "lastname": "rahadhian"
    },
    {
        "feedback_comment": "Lorem ipsum dolor sit amet,consetetur sadipscing elitr, seddiam nonu eirmod tempor invidunt labore.Lorem ipsum dolor sit amet,consetetur sadipscing elitr, seddiam nonu.",
        "feedback_point": 8,
        "user_id": 2,
        "firstname": "Bastien",
        "lastname": "Şenlikköy"
    },
    {
        "feedback_comment": "Lorem ipsum dolor sit amet,consetetur sadipscing elitr, seddiam nonu eirmod tempor invidunt labore.Lorem ipsum dolor sit amet,consetetur sadipscing elitr, seddiam nonu.",
        "feedback_point": 8,
        "user_id": 12,
        "firstname": "Thomas",
        "lastname": "Anderson"
    }
]

$(function () {
    //===== Section Menu Active
    var scrollLink = $('.page-scroll');
    // Active link switching
    $(window).scroll(function () {
        var scrollbarLocation = $(this).scrollTop();
        scrollLink.each(function () {
            var sectionOffset = $(this.hash).offset().top - 400;
            if (sectionOffset <= scrollbarLocation) {
                $(this).parent().addClass('active');
                $(this).parent().siblings().removeClass('active');
            }
        });
    });
    
    //===== Back to top
    // Show or hide the sticky footer button
    $(window).on('scroll', function (event) {
        if ($(this).scrollTop() > 600) {
            $('.back-to-top').fadeIn(200)
        } else {
            $('.back-to-top').fadeOut(200)
        }
    });

    //Animate the scroll to yop
    $('.back-to-top').on('click', function (event) {
        event.preventDefault();
        $('html, body').animate({
            scrollTop: 0,
        }, 1500);
    });

    //===== Counter Up
    $('.counter').counterUp({
        delay: 10,
        time: 1000
    });

    //===== remove enter keypress
    $("form").keypress(function(e) {
        //Enter key
        if (e.which == 13) {
            return false;
        }
    });

});

function handleKeyPress(e){
    var key= e.keyCode || e.which;
    if (key==13){
        indexSearch();
    }
}

function indexSearch() {
    var searchOpt = document.querySelector("#index-key").placeholder
    var searchKey = document.querySelector("#search-keywords").value

    var winLoc = window.location.href;
    if (winLoc.indexOf('_tr') > -1) { 
        if (searchKey !== "") {
            if (searchOpt == "İş arıyorum") {
                window.location = "search_employment_tr.html?keyword=" + searchKey;
                
            } else {
                window.location = "search_employees_tr.html?keyword=" + searchKey;
            }
        } else {
            return false;
        }
    } else {
        if (searchKey !== "") {
            if (searchOpt == "I'm looking for Job") {
                window.location = "search_employment_en.html?keyword=" + searchKey;
                
            } else {
                window.location = "search_employees_en.html?keyword=" + searchKey;
            }
        } else {
            return false;
        }
    }
    
}

// ===== Most View Job Slider
// $.ajax({
//     url: 'http://localhost:8000/api/v1.0/job/search_count',
//     headers: {
//         'Content-Type':'application/json'
//     },       
//     method: 'GET',
//     type: 'json',
//     success: function (res) {
//         mostViewRenderTemplate(res)
//     },
//     error: function (error) {
//         console.log(error);
//     }
// });

function mostViewRenderTemplate(data) {
    var flickityOptions =
        data.length < 4
            ? {
                cellAlign: "center",
                wrapAround: true,
                contain: true,
                pageDots: false,
                autoPlay: false,
                prevNextButtons: false,
                pauseAutoPlayOnHover: false
            }
            : {
                pageDots: false, 
                autoPlay: true,
                prevNextButtons: true,
                pauseAutoPlayOnHover: true, 
                wrapAround: true,
                contain: true,
            };

    if (data.length > 2) {
        var mostViewJob_element = "#mostViewJob .container .mostViewJob-slider";
        var sliderElement = document.querySelector(mostViewJob_element);
        var flkty = new Flickity(sliderElement, flickityOptions);

        data.slice(0, 10).map(function (el, key) {
            if (el.search_count > 10) {
                var requirements = []
                el.requirements.map(function (params) {
                    var dataParam = " " + params.required;
                    requirements.push(dataParam)
                })

                var winLoc = window.location.href;
                if (winLoc.indexOf('_tr') > -1) {
                    var url = "./detail_search_employment_tr.html?job_id=" + el.id
                    var btn = 'Şimdi Uygula <i class="lni-chevron-right"></i>'
                } else {
                    var url = "./detail_search_employment_en.html?job_id=" + el.id
                    var btn = 'Apply Now <i class="lni-chevron-right"></i>'
                }

                var carouselItem = document.createElement("div");
                carouselItem.classList.add("carousel-cell");
                carouselItem.innerHTML += `
                <div class="mostViewJob-content-result">
                    <div class="content-result">
                        <h4 class="content-result-title">${el.job_title}</h4>
                        <div class="content-result-desc mb-10">
                            <span class="content-result-company"><i class="lni lni-apartment"></i> ${el.company_name}</span>
                            <span class="content-result-"><i class="lni lni-map-marker"></i> ${el.job_location}</span>
                        </div>
                        <div class="content-result-summary">
                            <ul>
                                <li><span>${requirements[0]}</span></li>
                                <li><span>${requirements[1]}</span></li>
                            </ul>
                        </div>
                        <a href="${url}" class="main-btn mt-20">${btn}</a>
                    </div>
                </div>
                
                `;
                flkty.append(carouselItem);
            }
            
        });
    } else {
        document.querySelector('#mostViewJob').style.display = 'none'
    }
}

// ===== Most frequently Data
// $.ajax({
//     url: 'http://localhost:8000/api/v1.0/job/frequently',
//     headers: {
//         'Content-Type':'application/json'
//     },       
//     method: 'GET',
//     type: 'json',
//     success: function (res) {
//         frequentlyRenderTemplate(res)
//     },
//     error: function (error) {
//         console.log(error);
//     }
// });

function frequentlyRenderTemplate(data) {
    var frequently_element = "#frequently .container .frequently-searched-list";
    var Element = document.querySelector(frequently_element);
    var frequentlyItem = document.createElement("div");
    frequentlyItem.className = 'row';

    if (data.length > 0) {
        data.slice(0, 6).map(function (el, key) {
            // if (el.count > 4) {
                var winLoc = window.location.href;
                if (winLoc.indexOf('_tr') > -1) {
                    var url = "./search_employment_tr.html?keyword=" + el.job_title
                    var btn = 'Daha <i class="lni-chevron-right"></i>'
                } else {
                    var url = "./search_employment_en.html?keyword=" + el.job_title
                    var btn = 'See More <i class="lni-chevron-right"></i>'
                }

                frequentlyItem.innerHTML += `
                    <div class="col-lg-4">
                        <div class="single-services text-center mt-30 wow fadeIn" data-wow-duration="1s" data-wow-delay="0.2s">
                            <div class="services-content mt-30">
                                <h4 class="services-title">${el.job_title}</h4>
                                <span class="search-count counter">${el.count}</span>
                                <a href="${url}" class="main-btn mt-20">${btn}</a>
                            </div>
                        </div>
                    </div>
                `;
                Element.appendChild(frequentlyItem);
            // }
        });
    }

}

// ===== Most recently Data
// $.ajax({
//     url: 'http://localhost:8000/api/v1.0/job/page/1',
//     headers: {
//         'Content-Type':'application/json'
//     },       
//     method: 'GET',
//     type: 'json',
//     success: function (res) {
//         recentlyRenderTemplate(res[0])
//     },
//     error: function (error) {
//         console.log(error);
//     }
// });

function recentlyRenderTemplate(data) {
    var recently_element = "#recently .recently-list";
    var Element = document.querySelector(recently_element);
    var recentlyItem = document.createElement("ul");
    recentlyItem.classList.add("list-group");

    if (data.length > 0) {
        data.slice(0, 20).map(function (el, key) {
            var winLoc = window.location.href;
            if (winLoc.indexOf('_tr') > -1) {
                var url = "./detail_search_employment_tr.html?job_id=" + el.id
            } else {
                var url = "./detail_search_employment_en.html?job_id=" + el.id
            }

            recentlyItem.innerHTML += `
                <li class="list-group-item d-flex justify-content-between align-items-center border-left-red">
                    <a href="${url}">
                        <div class="recently-list-title">
                            ${el.job_title}
                            <ul class="recently-list-icons">
                                <li> ${el.company_name} </li>
                                <li><i class="lni lni-map-marker"></i> ${el.job_location}</li>
                            </ul>
                        </div>
                        <div class="recently-types-list"><span>${el.job_status}</span></div>
                    </a>
                </li>
            `;
            Element.appendChild(recentlyItem);
        });
    }
}


// ===== Feedback Data
// $.ajax({
//     url: 'http://localhost:8000/api/v1.0/feedback',
//     headers: {
//         'Content-Type':'application/json'
//     },       
//     method: 'GET',
//     type: 'json',
//     success: function (res) {
//         feedbackRenderTemplate(res)
//     },
//     error: function (error) {
//         console.log(error);
//     }
// });

function feedbackRenderTemplate(data) {
    var flickityOptions =
        data.length < 4
            ? {
                cellAlign: "center",
                wrapAround: true,
                contain: true,
                pageDots: false,
                autoPlay: false,
                prevNextButtons: false,
                pauseAutoPlayOnHover: false
            }
            : {
                pageDots: true, 
                autoPlay: true,
                prevNextButtons: false,
                pauseAutoPlayOnHover: true, 
                wrapAround: true,
                contain: true,
            };

    if (data.length > 2) {
        var feedback_element = "#feedback .container .testimonial-slider";
        var sliderElement = document.querySelector(feedback_element);
        var flkty = new Flickity(sliderElement, flickityOptions);

        data.map(function (el, key) {

            var carouselItem = document.createElement("div");
            carouselItem.classList.add("carousel-cell");
            carouselItem.innerHTML += `
                <div class="single-testimonial">
                    <div class="testimonial-review d-flex align-items-center justify-content-between">
                        <div class="quota">
                            <i class="lni-quotation"></i>
                        </div>
                    </div>
                    <div class="testimonial-text">
                        <p class="text">${el.feedback_comment}</p>
                    </div>
                    <div class="testimonial-author d-flex align-items-center">
                        <div class="author-content media-body">
                            <h6 class="holder-name">${el.firstname} ${el.lastname}</h6>
                        </div>
                    </div>
                </div>
            
            `;
            flkty.append(carouselItem);
        });
    } else {
        document.querySelector('#feedback').style.display = 'none'
    }
}

mostViewRenderTemplate(JobsData)
frequentlyRenderTemplate(frequentlyJobs)
recentlyRenderTemplate(JobsData)
feedbackRenderTemplate(feedback)