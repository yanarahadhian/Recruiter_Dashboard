var searchJobsData = [[
    {
        "id": 1,
        "user_id": 1,
        "company_name": "Trendyol",
        "job_status": "Full time",
        "job_title": "Production",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    },
    {
        "id": 2,
        "user_id": 1,
        "company_name": "Morbi",
        "job_status": "Full time",
        "job_title": "Mechanical engineering / Technical works",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    },
    {
        "id": 3,
        "user_id": 1,
        "company_name": "Batubara",
        "job_status": "Full time",
        "job_title": "Technical works",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    },
    {
        "id": 4,
        "user_id": 1,
        "company_name": "Doku",
        "job_status": "Full time",
        "job_title": "Software engineering",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    },
    {
        "id": 5,
        "user_id": 1,
        "company_name": "OVO",
        "job_status": "Full time",
        "job_title": "Mobile Apps Developer",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    }
],
    {
        "page_num": 1,
        "total_page": 1
    }
]

var JobsData = [
    {
        "id": 1,
        "user_id": 1,
        "company_name": "Trendyol",
        "job_status": "Full time",
        "job_title": "Production",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    },
    {
        "id": 2,
        "user_id": 1,
        "company_name": "Morbi",
        "job_status": "Full time",
        "job_title": "Mechanical engineering / Technical works",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    },
    {
        "id": 3,
        "user_id": 1,
        "company_name": "Batubara",
        "job_status": "Full time",
        "job_title": "Technical works",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    },
    {
        "id": 4,
        "user_id": 1,
        "company_name": "Doku",
        "job_status": "Full time",
        "job_title": "Software engineering",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    },
    {
        "id": 5,
        "user_id": 1,
        "company_name": "OVO",
        "job_status": "Full time",
        "job_title": "Mobile Apps Developer",
        "job_location": "Istanbul",
        "job_description": "Excelitas Technologies is a global technology leader focused on delivering innovative, high-performance, market-driven photonic solutions to meet the illumination, optronics, detection and optical technology needs of global customers. Serving a vast array of applications across biomedical, scientific, safety, security, consumer products, semiconductor, industrial manufacturing, defense and aerospace sectors, we stand committed to enabling our customers' success in their end-markets.",
        "search_count": 17,
        "timestamp": "2022-02-25",
        "requirements": [
            {
                "required": "Strong analytical and problem solving skills"
            },
            {
                "required": "Profound knowledge and experience in at least one modern object oriented programming language (C#,Java,Phyton)"
            },
            {
                "required": "Thorough and detailed way of working"
            },
            {
                "required": "Persistent and able to work well under pressure"
            },
            {
                "required": "Good communication skills and proactive attitude"
            },
            {
                "required": "Good knowledge on database technology (SQL,NoSQL)"
            }
        ],
        "preferreds": [
            {
                "preferred": "Good understanding of multiple forms of software testing throughout the entire SDLC: regression, functional, unit, black-box, white box, UAT, usability, stress testing, performance testing,etc."
            },
            {
                "preferred": "Prove of professional testing knowledge through a certificate like ‘ISTQB Certified Tester – Foundation Level’"
            },
            {
                "preferred": "Knowledge on test automation tools (Selenium, Appium, Cucumber)"
            },
            {
                "preferred": "Experience in a high paced agile development environment"
            },
            {
                "preferred": "Familiarity with Git, Gradle, Maven, application servers, Linux administration (Ubuntu/CentOS)."
            }
        ],
        "required_skills": [
            {
                "required_skill": "GitLab"
            },
            {
                "required_skill": "Unix/Linux Systems"
            },
            {
                "required_skill": "MySQL"
            },
            {
                "required_skill": "NoSQL"
            },
            {
                "required_skill": "MongoDB"
            }
        ]
    }
]

function searchEmploymentRenderTemplate(data) {
    var resultData = data[0]
    var resultPage = data[1]
    var btn_next = document.getElementById("btn_next");
    var btn_prev = document.getElementById("btn_prev");
    var page_span = document.getElementById("pageNum");
    var search_employment_element = "#employment-result .employment-result-list";
    var Element = document.querySelector(search_employment_element);
    var searchEmploymentItem = document.createElement("div");
    searchEmploymentItem.className = 'row';

    if (resultData.length > 0) {
        resultData.map(function (el, key) {
            var requirements = []
            el.requirements.map(function (params) {
                var dataParam = " " + params.required;
                requirements.push(dataParam)
            })

            var winLoc = window.location.href;
            if (winLoc.indexOf('_tr') > -1) {
                var url = "./detail_search_employment_tr.html?job_id=" + el.id
                var btn = 'Şimdi Uygula <i class="lni-chevron-right"></i>'
            } else {
                var url = "./detail_search_employment_en.html?job_id=" + el.id
                var btn = 'Apply Now <i class="lni-chevron-right"></i>'
            }

            searchEmploymentItem.innerHTML += `
                <div class="col-lg-4">
                    <div class="employe-content-result text-left mt-30">
                        <div class="content-result">
                            <h4 class="content-result-title">${el.job_title}</h4>
                            <div class="content-result-desc mb-10">
                                <span class="content-result-company"><i class="lni lni-apartment"></i> ${el.company_name}</span>
                                <span class="content-result-"><i class="lni lni-map-marker"></i> ${el.job_location}</span>
                            </div>
                            <div class="content-result-summary">
                                <ul>
                                    <li><span>${requirements[0]}</span></li>
                                    <li><span>${requirements[1]}</span></li>
                                </ul>
                            </div>
                            <a href="${url}" class="main-btn mt-20">${btn}</a>
                        </div>
                    </div>
                </div>
            `;
            Element.appendChild(searchEmploymentItem);

            if (winLoc.indexOf('_tr') > -1) {
                var prevBtn = "Önceki"
                var nextBtn = "Sonraki"
            } else {
                var prevBtn = "Previous"
                var nextBtn = "Next"
            }
            page_span.innerHTML = resultPage.page_num + "/" + resultPage.total_page;
            if (resultPage.page_num == 1) {
                btn_prev.classList.add("disabled")
            } else {
                btn_prev.classList.remove("disabled")
            }
            if (resultPage.page_num == resultPage.total_page) {
                btn_next.classList.add("disabled")
            } else {
                btn_next.classList.remove("disabled")
            }
    
            btn_prev.innerHTML = `<a class="page-link" href="javascript:prevPage(${resultPage.page_num})">${prevBtn}</a>`
            btn_next.innerHTML = `<a class="page-link" href="javascript:nextPage(${resultPage.page_num}, ${resultPage.total_page})">${nextBtn}</a>`
        });
    } else {
        searchEmploymentItem.innerHTML += `
        <div>No Result</div>
        `;
        Element.appendChild(searchEmploymentItem);
        document.querySelector('.pagination .page').style.display = 'none'
    }

}

function searchEmployment(page) {
    var elem = document.querySelector('#employment-result .employment-result-list .row')
    if (elem) {
        elem.parentNode.removeChild(elem);
    };
    var keywords = document.getElementById("intro-keywords").value.toLowerCase();
    var location = document.getElementById("search-location").value.toLowerCase();

    if (keywords !== '' || location !== '') {
        var apiUrl = `http://localhost:8000/api/v1.0/job/search?page=${page}&`
        var param = "";

        if (keywords !== "") {
            param += "keyword=" + keywords
            if (location !== "" ) {
                param += "&"
            }
        }
        if (location !== "") {
            param += "location=" + location
        }

        searchEmploymentRenderTemplate(searchJobsData)

        // $.ajax({
        //     url: apiUrl+param,
        //     headers: {
        //         'Content-Type':'application/json'
        //     },       
        //     method: 'GET',
        //     type: 'json',
        //     success: function (res) {
        //         $('html, body').animate({scrollTop: 1100}, 500);
        //         searchEmploymentRenderTemplate(res)
        //     },
        //     error: function (error) {
        //         console.log(error);
        //     }
        // });
    } else {
        searchEmploymentRenderTemplate(searchJobsData)
        // $.ajax({
        //     url: 'http://localhost:8000/api/v1.0/job/page/1',
        //     headers: {
        //         'Content-Type':'application/json'
        //     },       
        //     method: 'GET',
        //     type: 'json',
        //     success: function (res) {
        //         searchEmploymentRenderTemplate(res)
        //     },
        //     error: function (error) {
        //         console.log(error);
        //     }
        // });
    }    
}

function handleKeyPress(e){
    var key= e.keyCode || e.which;
    if (key==13){
        clickSearch()
    }
}

function clickSearch() {
    var elem = document.querySelector('#employment-result .employment-result-list .row')
    if (elem) {
        elem.parentNode.removeChild(elem);
    };
    searchEmployment(1);
}

function searchEmploymentView(page) {
    var elem = document.querySelector('#employment-result .employment-result-list .row')
    if (elem) {
        elem.parentNode.removeChild(elem);
    };
    var location = window.location.href
    var paramLoc = location.split("=")

    if (paramLoc.length > 1) {
        var valueLoc = paramLoc[1].replaceAll("%20", " ").replace("#", "")
        document.getElementById("intro-keywords").value = valueLoc
        searchEmployment(page);
    } else {
        searchEmploymentRenderTemplate(searchJobsData)
        // $.ajax({
        //     url: '',
        //     headers: {
        //         'Content-Type':'application/json'
        //     },       
        //     method: 'GET',
        //     type: 'json',
        //     success: function (res) {
        //         searchEmploymentRenderTemplate(res)
        //     },
        //     error: function (error) {
        //         console.log(error);
        //     }
        // });
    }
    
}

searchEmploymentView(1);

function prevPage(page){
    var keywords = document.getElementById("intro-keywords").value.toLowerCase();
    var location = document.getElementById("search-location").value.toLowerCase();

    if (keywords !== '' || location !== '') {
        if (page > 1) {
            page--;
            searchEmployment(page);
        }
    } else {
        if (page > 1) {
            page--;
            searchEmploymentView(page);
        }
    }
    
}

function nextPage(page, total_pages){
    var keywords = document.getElementById("intro-keywords").value.toLowerCase();
    var location = document.getElementById("search-location").value.toLowerCase();

    if (keywords !== '' || location !== '') {
        if (page < total_pages) {
            page++;
            searchEmployment(page);
        }
    } else {
        if (page < total_pages) {
            page++;
            searchEmploymentView(page);
        }
    }
    
}

// ===== Most View Job Slider
// $.ajax({
//     url: 'http://localhost:8000/api/v1.0/job/search_count',
//     headers: {
//         'Content-Type':'application/json'
//     },       
//     method: 'GET',
//     type: 'json',
//     success: function (res) {
//         mostViewRenderTemplate(res)
//     },
//     error: function (error) {
//         console.log(error);
//     }
// });

function mostViewRenderTemplate(data) {
    var flickityOptions =
        data.length < 4
            ? {
                cellAlign: "center",
                wrapAround: true,
                contain: true,
                pageDots: false,
                autoPlay: false,
                prevNextButtons: false,
                pauseAutoPlayOnHover: false
            }
            : {
                pageDots: false, 
                autoPlay: true,
                prevNextButtons: true,
                pauseAutoPlayOnHover: true, 
                wrapAround: true,
                contain: true,
            };

    if (data.length > 2) {
        var mostViewJob_element = "#mostViewJob .container .mostViewJob-slider";
        var sliderElement = document.querySelector(mostViewJob_element);
        var flkty = new Flickity(sliderElement, flickityOptions);

        data.slice(0, 10).map(function (el, key) {
            if (el.search_count > 10) {
                var requirements = []
                el.requirements.map(function (params) {
                    var dataParam = " " + params.required;
                    requirements.push(dataParam)
                })

                var winLoc = window.location.href;
                if (winLoc.indexOf('_tr') > -1) {
                    var url = "./detail_search_employment_tr.html?job_id=" + el.id
                    var btn = 'Şimdi Uygula <i class="lni-chevron-right"></i>'
                } else {
                    var url = "./detail_search_employment_en.html?job_id=" + el.id
                    var btn = 'Apply Now <i class="lni-chevron-right"></i>'
                }

                var carouselItem = document.createElement("div");
                carouselItem.classList.add("carousel-cell");
                carouselItem.innerHTML += `
                <div class="mostViewJob-content-result">
                    <div class="content-result">
                        <h4 class="content-result-title">${el.job_title}</h4>
                        <div class="content-result-desc mb-10">
                            <span class="content-result-company"><i class="lni lni-apartment"></i> ${el.company_name}</span>
                            <span class="content-result-"><i class="lni lni-map-marker"></i> ${el.job_location}</span>
                        </div>
                        <div class="content-result-summary">
                            <ul>
                                <li><span>${requirements[0]}</span></li>
                                <li><span>${requirements[1]}</span></li>
                            </ul>
                        </div>
                        <a href="${url}" class="main-btn mt-20">${btn}</a>
                    </div>
                </div>
                
                `;
                flkty.append(carouselItem);
            }
            
        });
    } else {
        document.querySelector('#mostViewJob').style.display = 'none'
    }
}

mostViewRenderTemplate(JobsData)